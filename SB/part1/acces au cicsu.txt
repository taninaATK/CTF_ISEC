======================== ATRIUM ==============================
1. Dans le cadre de notre campagne de communication intitulée
        "une sécurité maximale, mais avec la classe"
   nous vous rappelons que tous les utilisateurs de ce bâtiment
   doivent dorénavant avoir une clef publique RSA qui contient
   la chaîne "+++ATRIUM+++".

2. Cette chaîne promotionnelle doit se trouver à l'intérieur de la clef
   publique ; en particulier, elle ne doit pas être ajoutée au bout d'une
   clef pré-existante.  Autrement dit, ceci n'est pas autorisé  
       -----BEGIN PUBLIC KEY-----
       MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsHyqhsu3IxBYkCifvMrP
       uM/uv0hfq0PHbCfrUxFYooWLm3M0rru5Q+9BKQXqBRLa9iO+Tgn8Sy9+ABz0EJVd
       RRtatBkRj/UG3k+65UMxn5s47It+2sCXrX8TDmqPPtVa8Heo/5pqH1A/0LGj5YRo
       8GT0/ITj40j3I+Kp/1a9qP6+5eAqvUHfpC/hro2OCBAOi4+Q8qB+Zrx3jCa1l4R4
       0zQpvVf0nE+tjt7ZLBqlwKUnEWvVmFYJ3l/dikT9yG7s0UBOhAT8rZmwZVOluYeW
       yuERSus5TJbN8V9XR8q1lk8o7WBxtpyJotf5l/cCdmVlL9cSaZhVx26cAEcZ496z
       2QIDAQAB+++ATRIUM+++
       -----END PUBLIC KEY-----

3. Pour entrer dans le bâtiment ou dans les bureaux, il faut passer son
   badge devant le lecteur NFC.  Le badge doit contenir la clef publique,
   puis l'utilisateur doit réaliser une signature de manière interactive.

4. Pour simplifier la gestion des clefs, les occupants du même bureau 
   ont des clefs publiques RSA qui ont le même modulo (N).


>>> conseil lecteur nfc
Votre carte d'étudiant doit pouvoir être lue par ce dispositif.

>>> conseil lecteur nfc
Avez-vous lu le memento qui est dans la pièce à côté ?

>>> conseil lecteur nfc
Il vous faut produire une paire de clefs RSA dont la clef publique, 
encodée en base64, contient "+++ATRIUM+++".  Sans trop rentrer dans les
détails, la clef publique contient n et e, plus quelques octets de bourrage
à cause de la sérialisation asn.1 (c'est assez compliqué).  Il faut donc
que la "chaîne promotionnelle" apparaisse soit dans n soit dans e quand
on représente le tout en base64.


>>> conseil lecteur nfc
Entre n et e, c'est e qui est plus facile à contrôler : en effet on peut
le **choisir** librement lors de la création de la paire de clefs.  Mais
attention ! Il doit être impair.


>>> conseil lecteur nfc
L'encodage en base64 complique le tout (ne pas hésiter à lire la page 
wikipédia qui correspond).  En effet, chaque paquet de 6 bits est encodé en
un caractère.  3 octets du départ (24 bits) sont donc représentés par 4
caractères.  Si la "chaine promotionnelle" ne commence pas à une position
qui est un multiple de 3 dans la clef de départ, alors elle sera "à cheval"
sur des caractères ASCII différents, elle et n'apparaîtra pas correctement.
Une solution potentielle consiste à ajouter un ou deux octets AVANT dans e.


>>> conseil lecteur nfc
C'est tout !


16 blocs de 3 octets par ligne <=> 46 octets/lignes

-----BEGIN PUBLIC KEY-----
MIIBQjANBgkqhkiG9w0BAQEFAAOCAS8AMIIBKgKCASEAjLOA/FWqO34kHtYkjXLd    O > 47
e6/z88wzObwUXe4U0JgBKkT6vBg7g+avc1/qy/AbyfM7ygsZvc4gXUySCyipkolo    48 >
iOW4 wTe7 +SFT lI34 f0/0 n3v8 w++l cxrV KtUj oV6F abjv i/3V 0Rvf EG9t ZXAm asZL    96 >
96      99 102 105  108
SVuHl8VCAPT1s9Y1SyFyMhsGTVuYFTeuJmykk5KQ2epwiVswD16C0K2ixe5bL3om    142
lUOcbzovOHf1dEgTC7Z+MYuBDuiuLS9BTAJX+65tjY/MTmXnfIoh/Ck9Da16rN8z    190
O4LMt6vr+1DM9IA/1lPfghWCS4qXhV0DNnmAS3T6NIQSu3x6w+BsZKjIfG9hYwbE    238
fvEr gquL p4XRPKnMqukPVE+7fh+4eaN5cv22VR2NFSaDAgMBAAE=              286    
-----END PUBLIC KEY-----

PRIV
MIIFvAIBADALBgkqhkiG9w0BAQEEggWoMIIFpAIBAAKCASEAjLOA/FWqO34kHtYkjXLde6/z88wzObwUXe4U0JgBKkT6vBg7g+avc1/qy/AbyfM7ygsZvc4gXUySCyip koloiOW4wTe7+SFTlI34f0/0n3v8w++lcxrVKtUjoV6Fabjvi/3V0RvfEG9tZXAm asZLSVuHl8VCAPT1s9Y1SyFyMhsGTVuYFTeuJmykk5KQ2epwiVswD16C0K2ixe5b L3omlUOcbzovOHf1dEgTC7Z+MYuBDuiuLS9BTAJX+65tjY/MTmXnfIoh/Ck9Da16 rN8zO4LMt6vr+1DM9IA/1lPfghWCS4qXhV0DNnmAS3T6NIQSu3x6w+BsZKjIfG9h YwbEfvErgquLp4XRPKnMqukPVE+7fh+4eaN5cv22VR2NFSaDAgMBAAECggEgX4Co GJ79AYzJb7Ti8q/47i+sYttEGfgzyt4DeuLyR4JOg9llRvJsHhKeuzXref2ySTsv CyOZDv3uKONDwemUx0GZSmszEQu4Dd8qHEb8ZxurpSA6QBXIM6fKSACL/Zrycu6y KB6qmDqbEzx06wJwtJku1zdqq1E2NKk7jtb4Wa4AmxqIt7BGzydhBjSm/MXvX7sZ S9tSveijih7udCEV6fNbaGz+iJ/VpMP0owLAzx5jbh1dBxbX8/JUMOCeEyQxdITX AHJHbqTAjzi2DTFQQT0SKH/s4ZpcvlYNX0J9XdgUFVMq2Xz7bLdN4Gilpq4fO321 T1JXn04R2+5FwRHnyaUyypflILykHpRsYyRabnlxihAlp8HJ8rhPzLd7L/gBAoIB AQCTqfqTrZFzEVGeD+NFboKHRsEu7dTqgcSQh/ZiUft6QUUchW7nS2LJo2I18In7 3LFakLfrbVmJQ4JxI2PifdMV6Nh9xiWXzVl4gQqKgk3hcsgjkh4l+Sdo54TPVvK4 m9IV7RJ2TOtDnntIQlO3N3BR+uWwsvcdi5PGzkvEHSIcwmACY5+Ft/XFOZKUmwNJ fbibkuXyLGz51AqVeQp9L0K/koXJ/be8L/oZX5LiY+dXOGVKyUri+OcmiwJtJ7PQ lu5vCu4O5XiD/0f4pHV40PsYl9LYGnR9scPTCl9lKnJJaM47ljiyt2QyXw+FSlz2 7lCMCo2xXNcG0Kip0ZvYLLmDAiEA8+3ItPYH8kO2fUe5lRwiY6R2ZGG3xOkc1D1+ SQ5jTwECggEAW4yvRo/99ZFvQMgo6Asz8hrz+tyJfTsnW1RwdVTOzWVaK+yubchX Xxxk73xKkFSrwLKo1NXfBTNN1EdUzj+kd5j9YD1RYWR3bDbVCjrvfi9j1mnpNzHa NTgVJ1eI9NvmzKFHKQFXe3zugkZdEOLWSH19mqfaff7jiAavAs/tLld0nwaVCJqd TcH8FxZkW1QO+KWC2zqf9eR5C2MYFbUPdSaqvCkJmStFrCWNM78s1u6oHk3emAop hcP5pSNQYKqy+TWVkrbCmVPUk1ujWVx30S+QEVuVjbiA6H8t1dMTOGA6PMdOL79z 56b4QHNyX8YxOiHw513gEuGbMG48aTKRcQIhAKrypOs1VUJSdAz+fC/kpLEiLBqT ZP+pwxt28Q7v92cBAoIBAC1CDn7wKaz6LSJbNrkY/lVAzOtplh/234JlaZnAB/nI ZVwQzsp0LX6ZO0N2ZqgdCEpWWnrI4XaXml1M+nvu/Y8Ps0ENq6n9beG8XSaW/Nel 7KyuFNf54nvQi9jYhMjgjPbx94TwzEiT5xusuiQR1WFgfPplnIkGM1+kg0Yu1OSS KI+m5hEpF2PhAm4BmQIwusnx3/R9tvdl8d1wh3Yvs+XAq7VmptOXH279ujg6oQnH MnpQHcgIzX4O7Yd5p314eRj+hOBZp4b4g4rXPV92H9EV6xynTfEbfleHtjqNkqkW YA8hDTh0DZn5KtBQ2w4r3zZE6BLpzczzz9IQBTUDuow=

-----BEGIN PUBLIC KEY-----
MIIBQjANBgkqhkiG9w0BAQEFAAOCAS8AMIIBKgKCASEAjLOA/FWqO34kHtYkjXLde6/z88wzObwUXe4U0JgBKkT6vBg7g+avc1/qy/AbyfM7ygsZvc4gXUySCyipkoloiOW4wTe7+SFTlI34f0/0n3v8w++lcxrVKtUjoV6Fabjvi/3V0RvfEG9tZXAmasZLSVuHl8VCAPT1s9Y1SyFyMhsGTVuYFTeuJmykk5KQ2epwiVswD16C0K2ixe5bL3omlUOcbzovOHf1dEgTC7Z+MYuBDuiuLS9BTAJX+65tjY/MTmXnfIoh/Ck9Da16rN8zO4LMt6vr+1DM9IA/1lPfghWCS4qXhV0DNnmAS3T6NIQSu3x6w+BsZKjIfG9hYwbEfvErgquLp4XRPKnMqukPVE+7fh+4eaN5cv22VR2NFSaDAgMB+++ATRIUM+++AAE=
-----END PUBLIC KEY-----

EN HEX :

30 82 01 42 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 82 01 2f 00 30 82 01 2a 02 82 01 21 00 8c b3 80 fc 55 aa 3b 7e 24 1e d6 24 8d 72 dd 7b af f3 f3 cc 33 39 bc 14 5d ee 14 d0 98 01 2a 44 fa bc 18 3b 83 e6 af 73 5f ea cb f0 1b c9 f3 3b ca 0b 19 bd ce 20 5d 4c 92 0b 28 a9 92 89 68 88 e5 b8 c1 37 bb f9 21 53 94 8d f8 7f 4f f4 9f 7b fc c3 ef a5 73 1a d5 2a d5 23 a1 5e 85 69 b8 ef 8b fd d5 d1 1b df 10 6f 6d 65 70 26 6a c6 4b 49 5b 87 97 c5 42 00 f4 f5 b3 d6 35 4b 21 72 32 1b 06 4d 5b 98 15 37 ae 26 6c a4 93 92 90 d9 ea 70 89 5b 30 0f 5e 82 d0 ad a2 c5 ee 5b 2f 7a 26 95 43 9c 6f 3a 2f 38 77 f5 74 48 13 0b b6 7e 31 8b 81 0e e8 ae 2d 2f 41 4c 02 57 fb ae 6d 8d 8f cc 4e 65 e7 7c 8a 21 fc 29 3d 0d ad 7a ac df 33 3b 82 cc b7 ab eb fb 50 cc f4 80 3f d6 53 df 82 15 82 4b 8a 97 85 5d 03 36 79 80 4b 74 fa 34 84 12 bb 7c 7a c3 e0 6c 64 a8 c8 7c 6f 61 63 06 c4 7e f1 2b 82 ab 8b a7 85 d1 3c a9 cc aa e9 0f 54 4f bb 7e 1f b8 79 a3 79 72 fd b6 55 1d 8d 15 26 83 02 03 01 00 01

N OFFSET : 28
E OFFSET : 321


NEW PUB :
N = 2056685117895759328495758683464614862983597900204620148260197928980303571094456612545593917230039524879255716035399989204733574605038632384834411564348460914506516960636035184720044713736889253719999779171575736147640153369346273347088728344610841434693125143633173604088478373066123758788932817510451754920839716696372331706006826740187742566318759338327836767975363831556197831626642614294546061316296786349235571204436843769412412363767724435550070181299235536643201330052438640123441473327579816559694355454324956889394924553180980038659769842291081746484155727800663794323463501302143569004340609966616403413500116321922869454752377846798396437519990037194413588373934757153479761386088067
E = 304571393049442706679267329
D = 1029007763822514612409918433877812167280797609582894705040217711829935550880115367421271727877052656381023663473459190310758763559992368411081355298071304365119147733176924956807118782981510572509897535535957136011118358872977222373866629281377609687208932057821415186009479270142162457841718515940674426487527174335474449549456108527502691463859298002149701517003824658269179935222675879538740544392938728102227336507510792675421560011732358651302206263639357448409712572744515112090230241839584925978543383537051431232218830584034926042270277314438673766217938648925505807558085148570540810311634547405419265818048000387687509638127097125028693297608515505355849204957614740600960745549745153
P = 158603096439092436635973405520859921567838740194681432639372049095976305331723559584711318618087947058074036707066849056287536742702276221812089412158715019816559603663532687296062635083138997866779936937729725171615511404060381229914986093970064295480004859101041651483118275882946524746244535049022657261143
Q = 145959256179247596500384628375238622813520018052361234134824438799958503706721745758655851099412835028446438514605948022539333391080733147635327741563942408364279473798077617947666288217175264648525313547927481451299095709597570182243574159658658542900641283215633919325649218686371613261847496841299445760057145959256179247596500384628375238622813520018052361234134824438799958503706721745758655851099412835028446438514605948022539333391080733147635327741563942408364279473798077617947666288217175264648525313547927481451299095709597570182243574159658658542900641283215633919325649218686371613261847496841299445760057

P-1 = 18640850508126909703090815467180602773019794867580674698856654649711419722359659409979596870455137169814345975214064101814984991711650546519891074993983432422832073414339036879628211186822054974387720574621602256895055185088402711709734434439659203587841366198198456515432619257997699896774899928439475930718274885523510774417467563447844847834065117266088309381316112275429296595595959806678915635651451764766693477405433410402028576056645961482322024394745904242094831532386343267463909330440699157107163390873710014508306351000988794065564337109873526349284485330474699730721080461331252649759016447127355812264322
Q-1 = 110332150188056060348189195881839929313944390383943349674625762368619697884928

2056685117895759328495758683464614862983597900204620148260197928980303571094437971695085790320336434063788535432626969409865993930339775730184700144626101255096537363765580047550230367761675189618184794179864085601120262294352289914665896271196502397813496932446351549114090652491502156532037762325363352209129982261932672502418985373989544109803326719069839068078588931627758355695924339409022550541879318785787726356602778652146324054386408323274640884703639576836522414416787188358674779850174383149292326878268310927912602528786234134417675010758695403216691818470223095166356337911269858989832303615615414619434441652662807872342745172272039897859955012342698392374501114943983785875938816